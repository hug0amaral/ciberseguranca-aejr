<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CiberQuiz JR ‚Äì Testa a tua ciberseguran√ßa</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;margin:0;padding:0;background:#F7F7F7;color:#192B4D}
    header{background:#002F6C;color:#fff;padding:20px 10px}
    h1{margin:0;font-size:28px}
    .container{max-width:800px;margin:20px auto;padding:20px;background:#fff;box-shadow:0 0 10px rgba(0,0,0,.1)}
    button{background:#002F6C;color:#fff;border:none;padding:10px 20px;margin-top:10px;cursor:pointer;font-size:16px}
    button:hover{background:#405677}
    .question h2{font-size:20px}
    .answers label{display:block;margin:8px 0}
    .result{font-size:20px;margin-top:20px}
  </style>
</head>
<body>
  <header>
    <h1>CiberQuiz JR</h1>
    <p>Testa os teus conhecimentos de ciberseguran√ßa</p>
  </header>

  <div class="container" id="quiz-container">
    <!-- fallback inline: garante clique mesmo que JS n√£o ligue eventos -->
    <button id="start-btn" onclick="startQuizFromClick()">Iniciar Quiz</button>
  </div>

  <!-- Script no fim para garantir DOM carregado -->
  <script>
    const STATS_URL = 'https://script.google.com/macros/s/AKfycbykT3PpcCbNpP2gjFODX43Cjm4PfK0zcHgD98MvTv_ZGglBzG9RilqhaD6lKbGgeiiD/exec';

    function logEvent(payload){
      try{ fetch(STATS_URL,{method:'POST',mode:'no-cors',body:JSON.stringify(payload)}); }catch(_){}
    }

    // ===== Dados do quiz =====
    const quizData = [
      { question:"1. O que deves fazer antes de clicares num link num e-mail suspeito?",
        answers:["Responder ao e-mail para pedir confirma√ß√£o","Clicar de imediato porque parece urgente","Passar o rato sobre o link para ver o URL","Reencaminhar para todos os contactos"], correct:2 },
      { question:"2. Qual das op√ß√µes representa uma senha segura?",
        answers:["12345678","abcdefg","joaodarosa2025","M4iS_S3gUr@_2025"], correct:3 },
      { question:"3. O que √© o phishing?",
        answers:["Um v√≠rus que invade o computador","Um m√©todo para enganar algu√©m e obter dados pessoais","Um programa de antiv√≠rus","Um tipo de firewall"], correct:1 },
      { question:"4. A que se refere o termo 'autentica√ß√£o em dois fatores' (2FA)?",
        answers:["Usar dois computadores ao mesmo tempo","Usar uma password e outro m√©todo (SMS, app) para confirmar a identidade","Ter duas contas de e-mail","Fazer o login duas vezes seguidas"], correct:1 },
      { question:"5. Qual √© o comportamento mais seguro ao usar Wi-Fi p√∫blico?",
        answers:["Aceder a servi√ßos banc√°rios normalmente","Partilhar a liga√ß√£o com amigos","Evitar inserir dados pessoais ou fazer compras online","Usar a mesma senha do Wi-Fi em casa"], correct:2 },
      { question:"6. O que √© uma firewall?",
        answers:["Uma parede de fogo","Um software ou hardware que filtra acessos √† rede","Um tipo de antiv√≠rus online","Um disco r√≠gido externo"], correct:1 },
      { question:"7. Como agir se receberes um e-mail de desconhecido com anexo?",
        answers:["Abrir o anexo para ver o conte√∫do","Apagar/Spam sem abrir o anexo","Responder a perguntar quem √©","Partilhar o anexo com um amigo"], correct:1 },
      { question:"8. Porque √© importante atualizar o software?",
        answers:["Novas funcionalidades e corre√ß√µes de seguran√ßa","Porque √© obrigat√≥rio por lei","Para gastar dados","Para apagar v√≠rus j√° instalados"], correct:0 },
      { question:"9. Exemplo de not√≠cia falsa (fake news)?",
        answers:["Fonte oficial com data e autor","Sensacionalista a pedir partilha sem fontes","Artigo cient√≠fico com refer√™ncias","Not√≠cia do site da escola"], correct:1 },
      { question:"10. Se suspeitares de roubo de identidade, o que fazer?",
        answers:["Ignorar","Partilhar nas redes sociais","Reportar √†s autoridades e alterar senhas","Fazer login em todas as contas"], correct:2 }
    ];

    const quizContainer = document.getElementById('quiz-container');
    const startBtn = document.getElementById('start-btn');

    let currentQuestion = 0;
    let score = 0;

    // redund√¢ncia: tamb√©m liga via JS quando o DOM carregar
    window.addEventListener('DOMContentLoaded', function(){
      if(startBtn){
        startBtn.addEventListener('click', startQuizFromClick);
      }
    });

    // fun√ß√£o global chamada pelo onclick inline (fallback √† prova de bala)
    function startQuizFromClick(){
      logEvent({ event:'start', ua:navigator.userAgent });
      startQuiz();
    }

    function startQuiz(){
      currentQuestion = 0;
      score = 0;
      if(startBtn) startBtn.style.display = 'none';
      showQuestion();
    }

    function showQuestion(){
      const q = quizData[currentQuestion];
      quizContainer.innerHTML = '';

      const questionElem = document.createElement('div');
      questionElem.className = 'question';
      questionElem.innerHTML = '<h2>'+ q.question +'</h2>';

      const answersElem = document.createElement('div');
      answersElem.className = 'answers';
      q.answers.forEach(function(ans,i){
        const label = document.createElement('label');
        label.innerHTML = '<input type="radio" name="quiz" value="'+i+'"> ' + ans;
        answersElem.appendChild(label);
      });

      const nextBtn = document.createElement('button');
      nextBtn.textContent = currentQuestion < quizData.length - 1 ? 'Pr√≥xima' : 'Ver Resultado';
      nextBtn.addEventListener('click', nextQuestion);

      quizContainer.appendChild(questionElem);
      quizContainer.appendChild(answersElem);
      quizContainer.appendChild(nextBtn);
    }

    function nextQuestion(){
      const selected = document.querySelector('input[name="quiz"]:checked');
      if(!selected){ alert('Seleciona uma resposta antes de continuar!'); return; }
      if(parseInt(selected.value,10) === quizData[currentQuestion].correct){ score++; }
      currentQuestion++;
      if(currentQuestion < quizData.length) showQuestion();
      else showResult();
    }

    function showResult(){
      quizContainer.innerHTML = '';
      const percent = Math.round((score / quizData.length) * 100);

      logEvent({ event:'finish', percent, success:(percent>=80), ua:navigator.userAgent });

      let feedback='', trophy='';
      if (percent < 40)       feedback = 'Iniciante ‚Äì continua a aprender e a proteger-te!';
      else if (percent < 80)  feedback = 'Cuidadoso ‚Äì est√°s no bom caminho, mas ainda h√° espa√ßo para melhorar.';
      else if (percent < 100) feedback = 'Muito bem! Mas tenta alcan√ßar os 100% para te tornares um Agente Digital.';
      else { feedback='Agente Digital ‚Äì excelente, √©s um verdadeiro defensor da seguran√ßa digital!'; trophy=' üèÜ'; playBeep(); }

      const resultDiv = document.createElement('div');
      resultDiv.className = 'result';
      resultDiv.innerHTML = `<p>A tua pontua√ß√£o: <strong>${percent}%</strong>${trophy}</p><p>${feedback}</p>`;

      const retryBtn = document.createElement('button');
      retryBtn.textContent = 'Jogar de novo';
      retryBtn.addEventListener('click', function(){
        quizContainer.innerHTML = '';
        if(startBtn){
          startBtn.style.display = '';
          quizContainer.appendChild(startBtn);
        }
      });

      quizContainer.appendChild(resultDiv);
      quizContainer.appendChild(retryBtn);
    }

    function playBeep(){
      const ctx = new (window.AudioContext||window.webkitAudioContext)();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.type='square';
      osc.frequency.setValueAtTime(520,ctx.currentTime);
      gain.gain.setValueAtTime(0.05,ctx.currentTime);
      osc.connect(gain); gain.connect(ctx.destination);
      osc.start(); osc.stop(ctx.currentTime+0.6);
    }
  </script>
</body>
</html>
